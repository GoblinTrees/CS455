<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Robot Control</title>
<script>
  var ip_add = "{{ ip_address }}"; // Get the IP address from Flask
  var form_send = ip_add + "/control";
  function sendData() {
    var form = document.getElementById("robotControlForm");
    var sliders = form.getElementsByTagName("input");
    var joystickX = document.getElementById("joystickX").value;
    var joystickY = document.getElementById("joystickY").value;
    var formData = new FormData();

    // Loop through sliders, add their values to formData
    for (var i = 0; i < sliders.length; i++) {
      if (sliders[i].type === "range") {
        formData.append(sliders[i].name, sliders[i].value);
      }
    }

    // Add joystick values to formData
    formData.append("joystickX", joystickX);
    formData.append("joystickY", joystickY);

    // Send formData to the Flask backend
    fetch("/control", {
      method: "POST",
      body: formData
    })
    .then(response => {
      if (!response.ok) {
        throw new Error("Network response was not ok");
      }
      return response.text();
    })
    .then(data => {
      console.log(data); // Log the response from the backend
    })
    .catch(error => {
      console.error("There was a problem with the fetch operation:", error);
    });
  }

  // Function to call sendData() whenever the input event occurs on sliders or joysticks
  function bindInputEvents() {
    var form = document.getElementById("robotControlForm");
    form.action = form_send;
    var inputs = form.getElementsByTagName("input");
    for (var i = 0; i < inputs.length; i++) {
      if (inputs[i].type === "range") {
        inputs[i].addEventListener("input", sendData);
      }
    }
  }

  // Bind input events when the document is loaded
  document.addEventListener("DOMContentLoaded", bindInputEvents);
</script>
</head>
<body>
<h2>Robot Control Interface</h2>
<form id="robotControlForm" action="http://192.168.88.58:3245/control" method="post">
  <label for="slider1">HeadTilt:</label>
  <input type="range" id="slider1" name="slider1" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider2">HeadTurn:</label>
  <input type="range" id="slider2" name="slider2" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider3">LShoulder:</label>
  <input type="range" id="slider3" name="slider3" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider4">LBicep</label>
  <input type="range" id="slider4" name="slider4" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider5">Lelbow</label>
  <input type="range" id="slider5" name="slider5" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider6">Lwrist</label>
  <input type="range" id="slider6" name="slider6" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider7">Lclaw</label>
  <input type="range" id="slider7" name="slider7" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider8">RShoulder</label>
  <input type="range" id="slider8" name="slider8" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider9">RBicep</label>
  <input type="range" id="slider9" name="slider9" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider10">Relbow</label>
  <input type="range" id="slider10" name="slider10" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider11">Rwrist</label>
  <input type="range" id="slider11" name="slider11" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider12">Rclaw</label>
  <input type="range" id="slider12" name="slider12" min="3000" max="9000" value="6000" step="200"><br>

  <label for="slider13">Waist:</label>
  <input type="range" id="slider13" name="slider13" min="3000" max="9000" value="6000" step="200"><br>

  <!-- Joystick -->
  <label for="joystickX">Joystick X:</label>
  <input type="range" id="joystickX" name="joystickX" min="-100" max="100" value="0" step="1"><br>
  <label for="joystickY">Joystick Y:</label>
  <input type="range" id="joystickY" name="joystickY" min="-100" max="100" value="0" step="1"><br>

  <input type="button" value="Submit" onclick="sendData()">
</form>
</body>
</html>
