<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Robot Control</title>
    <!--    <link href="styles.css" rel="stylesheet">-->
    <style>
        html, body {
            height: 100%;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%; /* Set to 100% to take the full width of the viewport */
            max-width: 1200px; /* Set a maximum width to limit the width of the content */
            margin: auto; /* Center the container horizontally */
        }

        body {
            margin: 0;
            font-family: Arial, sans-serif; /* You can change the font-family if needed */
            background-color: dimgrey; /* Set a background color for the body */
            flex-direction: row;
            height: 100%; /* Set body height */
            width: 100%;
        }

        #display {
            display: flex;
            flex-direction: row;
            background-color: goldenrod;
            /*justify-content: center;*/
            align-items: center;
            justify-content: center;
            width: 100%;
            height: auto;
            /*width: 800px; !* Set width to 800px *!*/
            /*height: 600px; !* Set height to 600px *!*/
            background-color: goldenrod; /* Set background color */
            overflow: scroll; /* Add overflow for scrolling if needed */
            overflow: auto;
        }

        #outer {
            background-color: darkgray;
            width: 430px;
            height: 330px;

            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #queueOuter {
            background-color: #333; /* Dark theme background color */
            color: #fff; /* Dark theme text color */
            padding: 20px; /* Add padding for spacing */
            text-align: center; /* Center-align text */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 230px;
            height: 290px;
        }

        #queueContainer {
            background-color: #f0f0f0; /* Light theme background color */
            color: #333; /* Light theme text color */
            text-align: center; /* Center-align text */
            width: 100%; /* Take up full width of the parent container */
            height: 100%;
            max-width: 290px; /* Limit the width to leave space for buttons */
        }

        #forandqueue {
            display: flex;
            flex-direction: row;
        }

        #dashboard {
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 2px;
            margin-bottom: 20px;
            width: 63px;
            height: 600px;
        }

        #dashboard h3 {
            margin-top: 0;
            margin-bottom: 2px;
        }

        #head_sliders {
            background-color: chocolate;
            width: 250px;
            margin-bottom: 2px;
        }

        #upper {
            display: flex;
            flex-direction: row;
            margin-bottom: 2px;
        }

        #lastrow {
            display: flex;
            flex-direction: row;
        }

        #lastR {
            display: flex;
            flex-direction: column;
        }

        .input-field {
            width: 150px;
            height: 200px;
            border: none;
            outline: none;
            resize: inline;
            font-size: 16px;
        }


        #Qremove,
        #Qadd {
            width: 40px;
            height: 30px;
            background-color: #4CAF50; /* Green background */
            color: white; /* White text color */
            border: none; /* Remove border */
            border-radius: 4px; /* Add border-radius for rounded corners */
            cursor: pointer; /* Change cursor to pointer on hover */
            margin: 5px; /* Add margin for spacing between buttons */
        }

        #Qremove:hover,
        #Qadd:hover {
            background-color: #45a049; /* Darker shade of green on hover */
        }

        #Qremove {
            background: darkred;
        }

        #Qremove:hover {
            background-color: maroon; /* Darker shade of red on hover */

        }

        .quickset {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            background: darkkhaki;
            align-content: center;
            align-items: center;
            justify-content: center; /* Horizontally center the content */
            width: 700px;
        }

        /* Stylized button */
        button {
            background-color: #4CAF50; /* Green background */
            color: white; /* White text */
            padding: 10px 20px; /* Padding for spacing */
            text-align: center; /* Center-align text */
            text-decoration: none; /* Remove default underline */
            display: inline-block; /* Make it inline-block for proper alignment */
            font-size: 16px; /* Font size */
            cursor: pointer; /* Cursor style */
            border-radius: 4px; /* Rounded corners */
            transition: background-color 0.3s ease; /* Smooth transition for background color */
            border: 1px solid #ccc;
        }

        /* Change button background color on hover */
        button:hover {
            background-color: #45a049; /* Darker shade of green */
        }

        /* Styles for head sliders */


        /* Styles for left arm sliders */
        #L_arm_sliders {
            background-color: salmon;
            width: 200px;
            margin-right: 20px;
        }

        /* Styles for right arm sliders */
        #R_arm_sliders {
            background-color: salmon;
            width: 200px;
        }

        /* Styles for body sliders */
        #body_sliders {
            background-color: dodgerblue;
            width: 100%;
            margin-bottom: 20px;
        }

        /* Styles for wheel sliders */
        #Wheel_Sliders {
            background-color: darkgreen;
            width: 220px;
        }


        #base {
            display: flex;
            flex-direction: row;
            padding: 20px;
            align-content: center;
            align-items: center;
        }

        #strip {
            display: flex;
            flex-direction: column;
            align-items: center;
            align-content: center;
        }

        #sliderValues p {
            margin: 5px 0;
        }

        .button-container button {
            margin: 0 5px; /* Adjust the margin as needed */
            background-color: #2d2a2a;
            color: darkgoldenrod;
            width: 40px;
            height: auto;
        }

        .input-container {
            height: 60px; /* Minimum height */
            max-height: 200px; /* Maximum height */
            overflow-y: auto; /* Add scroll if content exceeds height */
            border: 1px solid #ccc;
            padding: 5px;
        }

        .button-container1 {
            background-color: #333; /* Dark theme background color */
            color: #fff; /* Dark theme text color */
            padding: 20px; /* Add padding for spacing */
            text-align: center; /* Center-align text */
            display: flex;
            justify-content: center;
            align-items: center;
            width: 660px;

        }

        .button-container2 {
            background-color: #333; /* Dark theme background color */
            color: #fff; /* Dark theme text color */
            padding: 2px; /* Add padding for spacing */
            text-align: center; /* Center-align text */
            display: flex;
            flex-direction: row;
            justify-content: space-evenly;
            align-items: center;
        }

        .qbutton {
            border: #2d2a2a;
            border-radius: 15px;
            background-color: forestgreen;
            align-content: center;
            align-items: center;
            justify-content: center; /* Horizontally center the content */
        }

        .actbutton {
            width: 85px;
            height: auto;
            background: darkgreen;
            color: darkgoldenrod;
        }

        #sliderValues {
            font-size: 12px; /* Set the desired font size */
        }

        #queue {
            width: 100%;
            height: auto;
        }


        /*@media only screen and (min-device-width: 800px) and (max-device-width: 800px) and (min-device-height: 480px) and (max-device-height: 480px) {*/
        /*    !* Your CSS styles specific to the Raspberry Pi 7-inch display *!*/
        /*    !* For example, you can adjust the layout or dimensions *!*/
        /*}*/


    </style>


</head>
<body>
<div id="display">

    <div id="dashboard">
        <h5>Slider Values</h5>
        <div id="sliderValues">
            <!-- Slider values will be displayed here dynamically -->
        </div>
    </div>


    <div>
        <div id="forandqueue">
            <iframe id="dummyframe" name="dummyframe" style="display: none;"></iframe>
            <form action="http://192.168.88.58:3245/gui" id="robotControlForm" method="post" target="dummyframe">
                <div id="outer">
                    <div id="head_sliders">
                        <label for="slider1">HeadTilt:</label>
                        <input id="slider1" max="9000" min="3000" name="Headtilt" step="200" type="range"
                               value="6000"><br>

                        <label for="slider2">HeadTurn:</label>
                        <input id="slider2" max="9000" min="3000" name="Headturn" step="200" type="range"
                               value="6000"><br>
                    </div>
                    <div id="upper">
                        <div id="L_arm_sliders">
                            <label for="slider3">LShoulder:</label>
                            <input id="slider3" max="9000" min="3000" name="Lshoulder" step="200" type="range"
                                   value="6000"><br>

                            <label for="slider4">LBicep</label>
                            <input id="slider4" max="9000" min="3000" name="Lbicep" step="200" type="range"
                                   value="6000"><br>

                            <label for="slider5">Lelbow</label>
                            <input id="slider5" max="9000" min="3000" name="Lelbow" step="200" type="range"
                                   value="6000"><br>

                            <label for="slider6">Lwrist</label>
                            <input id="slider6" max="9000" min="3000" name="Lwrist" step="200" type="range"
                                   value="6000"><br>

                            <label for="slider7">Lclaw</label>
                            <input id="slider7" max="9000" min="3000" name="Lclaw" step="200" type="range" value="6000"><br>
                        </div>

                        <div id="R_arm_sliders">
                            <label for="slider8">RShoulder</label>
                            <input id="slider8" max="9000" min="3000" name="Rshoulder" step="200" type="range"
                                   value="6000"><br>

                            <label for="slider9">RBicep</label>
                            <input id="slider9" max="9000" min="3000" name="Rbicep" step="200" type="range"
                                   value="6600"><br>

                            <label for="slider10">Relbow</label>
                            <input id="slider10" max="9000" min="3000" name="Relbow" step="200" type="range"
                                   value="6000"><br>

                            <label for="slider11">Rwrist</label>
                            <input id="slider11" max="9000" min="3000" name="Rwrist" step="200" type="range"
                                   value="6000"><br>

                            <label for="slider12">Rclaw</label>
                            <input id="slider12" max="9000" min="3000" name="Rclaw" step="200" type="range"
                                   value="6000"><br>
                        </div>

                    </div>
                    <div id="lastrow">
                        <div id="Wheel_Sliders">

                            <div id="body_sliders">
                                <label for="slider13">Waist:</label>
                                <input id="slider13" max="9000" min="3000" name="Waist" step="200" type="range"
                                       value="6000"><br>
                            </div>
                            <label for="L_Motors">L_Motor</label>
                            <input id="L_Motors" max="9000" min="3000" name="L_Motors" step="200" type="range"
                                   value="6000"><br>
                            <label for="R_Motors">R_Motor</label>
                            <input id="R_Motors" max="9000" min="3000" name="R_Motors" step="200" type="range"
                                   value="6000"><br>
                        </div>
                        <div id="lastR">
                            <div class="input-container">
                                <textarea class="input-field" id="UserSpeech" placeholder="Speak friend and enter"
                                          rows="1"></textarea>
                            </div>
                            <div id="timers">
                                <label for="slider20">Duration</label>
                                <input id="slider20" max="180" min="1" name="Duration" step="1" type="range"
                                       value="0"><br>
                                <label for="slider21">Delay</label>
                                <input id="slider21" max="1" min="0" name="Delay" step="1" type="range" value="0"><br>
                            </div>
                            <!--                    <input onclick="sendDatatype="button"value="Send">-->
                        </div>

                    </div>
                </div>
            </form>

            <div id="queueOuter">
                <h5>Queue</h5>
                <div id="queueContainer">

                    <div class="input-container" id="queue">
                        <!-- Queue items will be displayed here dynamically -->
                    </div>
                </div>
                <div class="button-container2">
                    <!-- Add a button to remove items from the queue -->
                    <button class="qbutton" id="Qremove" onclick="removeFromQueue()">-</button>
                    <!-- Add a button to add items to the queue -->
                    <button class="qbutton" id="Qadd" onclick="addToQueue()">+</button>
                    <!-- Add a button to add items to the queue -->
                    <button class="qbutton" id="Set" onclick="setQueue()">Set</button>
                </div>
            </div>
        </div>

        <div class="quickset">
            <button class="qbutton" id="button1" onclick="_">Left 45</button>
            <button class="qbutton" id="button2" onclick="forward()">Forward</button>
            <button class="qbutton" id="button3" onclick="_">Right 45</button>
            <button class="qbutton" id="button4" onclick="_">Left 90</button>
            <button class="qbutton" id="button5" onclick="reverse()">Reverse</button>
            <button class="qbutton" id="button6" onclick="_">Right 90</button>
            <button class="qbutton" id="button7" onclick="_">Set 1 Time unit</button>
            <button class="qbutton" id="button8" onclick="_">Neutral</button>
            <button class="qbutton" id="button9" onclick="_">+1 Time unit</button>

        </div>
        <div class="button-container1">
            <button class="actbutton" onclick="window.close()">Exit Interface</button>
            <button class="actbutton" onclick="humanInput()">Human Input</button>
            <button class="actbutton" onclick="savePreset()">Save Preset</button>
            <button class="actbutton" onclick="loadPreset()">Load Preset</button>
            <!--<button class="actbutton" onclick="window.location.href='url5';">Toggle Phrase</button>-->
            <button class="actbutton" onclick="speakLine()">Speak Line</button>
            <!--<button class="actbutton" onclick="">Chain Function</button>-->
            <button class="actbutton" onclick=""><a href="http://192.168.137.188:5245/exec">Run Program</a>
            </button>
        </div>
    </div>


    <script>
        function forward() {
            document.getElementById("L_Motors").value = 5400
            document.getElementById("R_Motors").value = 7000
        }

        function reverse() {
            document.getElementById("L_Motors").value = 6600
            document.getElementById("R_Motors").value = 5000
        }

        function left90() {

        }

        function updateDashboard() {
            var sliders = document.querySelectorAll('input[type="range"]');


            var dashboardContent = "";
            sliders.forEach(function (slider) {
                dashboardContent += "<p>" + slider.name + ": " + slider.value + "</p>";
            });

            // var delaySlider = document.getElementById('slider21');
            // var durationSlider = document.getElementById('slider20');
            //
            // dashboardContent += "<p>" + delaySlider.name + ": " + delaySlider.value + "</p>";
            // dashboardContent += "<p>" + durationSlider.name + ": " + durationSlider.value + "</p>";


            document.getElementById("sliderValues").innerHTML = dashboardContent;
            // sendData();
        }

        // Bind input events when the document is loaded
        document.addEventListener("DOMContentLoaded", function () {
            bindInputEvents();
            updateDashboard(); // Update dashboard initially
        });

        // Function to bind input events to sliders
        function bindInputEvents() {
            var form = document.getElementById("robotControlForm");
            var sliders = form.getElementsByTagName("input");
            for (var i = 0; i < sliders.length; i++) {
                if (sliders[i].type === "range") {
                    sliders[i].addEventListener("input", updateDashboard); // Add event listener to each slider
                }
            }
        }

        function humanInput(){
            var delayValue = document.getElementById("slider21").value;
            if (delayValue == 1){
                document.getElementById("slider21").value = 0;
            } else {
                document.getElementById("slider21").value = 1;
            }
        }
        /*
        var speechRecognition = window.webkitSpeechRecognition
        var recognition = new speechRecognition()
        var instructions = document.getElementById("speechInputButton")
        var content = ''
        var textbox = document.getElementById("UserSpeech")

        recognition.continuous = true

        // recognition is started

        recognition.onstart = function() {
            instructions.value("Voice Recognition is On")
        }

        recognition.onspeechend = function() {
            instructions.value("Human Input")
            var msg = new SpeechSynthesisUtterance();
            msg.text = "Thank you for your request. We will process it when resources become available"
            window.speechSynthesis.speak(msg);
        }

        recognition.onerror = function() {
            instruction.value("Try Again")
        }

        recognition.onresult = function(event) {
            var current = event.resultIndex;
            var transcript = event.results[current][0].transcript
            content += transcript
            textbox.val = content
        }

        function speechToText() {
            recognition.start()
        }*/

        var sampleSpeech = ["Hello new friend", "How are you", "How can I help you today", "I don't get paid enough oil for this"];

        function speakLine() {
            var input = document.getElementById("UserSpeech").value;
            if (input == "") {
                document.getElementById("UserSpeech").value = sampleSpeech[Math.floor(Math.random() * sampleSpeech.length)];
            } 
        }

        // Define a global array to act as the queue
        var queue = [];
        var preset = [];

        function savePreset() {
            preset = [];
            for (var i = 0; i < queue.length; i++) {
                preset.push(queue[i]);
            }
        }

        function loadPreset() {
            for (var i = 0; i < preset.length; i++) {
                queue.push(preset[i]);
            }
            updateQueueDisplay();
        }

        // Function to add items to the queue
        function addToQueue() {
            var form = document.getElementById("robotControlForm");
            var sliders = form.getElementsByTagName("input");
            var queueItem = {}; // Object to hold the slider values

            // Loop through sliders, add their values to the queue item
            for (var i = 0; i < sliders.length; i++) {
                if (sliders[i].type === "range") {
                    queueItem[sliders[i].name] = sliders[i].value;
                }
            }

            // Add the queue item to the queue array
            queue.push(queueItem);

            // Add the value of the text field "UserSpeech" to the queue item
            var userSpeechValue = document.getElementById("UserSpeech").value; 
            queueItem["Words"] = userSpeechValue;

            document.getElementById("UserSpeech").value = "";
            // Update the displayed queue
            updateQueueDisplay();
        }

        // Function to remove items from the queue
        function removeFromQueue() {
            if (queue.length > 0) {
                queue.shift(); // Remove the first item from the queue
                updateQueueDisplay(); // Update the displayed queue
            }
        }

        function setQueue() {
            console.log("Setting Queue...");
            // Get the content of the queue element
            var queueContent = document.getElementById("queue").innerHTML;

            // Specify the URL to send the data to
            var url = "http://192.168.137.188:5245/setQue"; // send to setQue

            // Convert the queue content to JSON
            var jsonData = JSON.stringify({queueContent: queueContent});

            // Create the request configuration
            var requestOptions = {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: jsonData
            };

            // Send the request using the fetch API
            fetch(url, requestOptions)
                .then(function (response) {
                    // Check if the request was successful (status code 200)
                    if (response.ok) {
                        // Request was successful, do something with the response if needed
                        console.log("Queue content sent successfully!");
                    } else {
                        // Request failed, handle the error
                        console.error("Error sending queue content. Status code: " + response.status);
                    }
                })
                .catch(function (error) {
                    // Handle any network errors
                    console.error("Network error:", error);
                });
        }


        // Function to update the displayed queue
        function updateQueueDisplay() {
            var queueContent = "";

            // Loop through the queue items and display them
            for (var i = 0; i < queue.length; i++) {
                queueContent += "<p>" + JSON.stringify(queue[i]) + "</p>";
            }

            // Update the content of the queue div
            document.getElementById("queue").innerHTML = queueContent;
        }
    </script>
</div>
</div>
</body>
</html>
